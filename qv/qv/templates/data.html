{% extends 'base.html' %}

{% block title %}{{dataset.name}}{% endblock %}

{% block head %}
<style>
    .dataHolder{
        float:left;
        height:500px;
        overflow:scroll;
        margin-left:10px;
        margin-right:10px;
        }
    .chartHolder{
        float:left;
        overflow:scroll;
        margin-left:10px;
        margin-right:10px;
        min-width:300px;
        min-height:200px;
    }
    .dataHolder table{
        width:100%;
    }
    .dataHolder table tr:nth-child(even){
        background-color: #CCC;
    }
    .ui-resizable{float:left;}
    .axis path,
    .axis line {
        fill: none;
        stroke: black;
        shape-rendering: crispEdges;
    }
    
    .axis text {
        font-family: sans-serif;
        font-size: 11px;
    }
    #sliderHolder {
        width:90%;
        margin-left:auto;
        margin-right:auto;
    }
    #slider {
        width:100%;
    }
</style>
{% endblock%}

{% block content %}
<h1>{{dataset.name}}</h1>
<p>{{dataset.data|length|add:"-1"}} rows {% if dataset.data|length|add:"-1" > 1000 %}, showing first 1000{% endif %}</p>
<div id="table" class="dataHolder ui-widget-content resizable"></div>
<div id="bar" class="chartHolder ui-widget-content resizable"></div>
<div id="area" class="chartHolder ui-widget-content resizable"></div>
<script>
//Make divs resizable
$(".resizable")
      .wrap('<div/>')
        .css({'overflow':'hidden'})
          .parent()
            .css({'display':'inline-block',
                  'overflow':'hidden',
                  'height':function(){return $('.resizable',this).height();},
                  'width':  'auto',
                  'paddingBottom':'12px',
                  'paddingRight':'22px'
                  
                 }).resizable()
                    .find('.resizable')
                      .css({overflow:'auto',
                            width:'100%',
                            height:'100%'});
//Import data from Django
var data = {{dataset.data|safe}};
var xVar = "{{dataset.xVar|safe}}";
var yVar = "{{dataset.yVar|safe}}";
var timeVar = "{{dataset.timeVar|safe}}";
table({'selector':'.dataHolder#table'
      ,'data':data
      ,'xVar': xVar
      ,'timeVar':timeVar
      })
bar({'selector':'.chartHolder#bar'
    ,'data':data
    ,'yVar':yVar
    ,'xVar':xVar
    ,'timeVar':timeVar
    })
area({'selector':'.chartHolder#area'
     ,'data':data
    ,'yVar':yVar
    ,'xVar':xVar
    ,'timeVar':timeVar
     })
</script>
{% endblock %}